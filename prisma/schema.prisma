generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Donation {
  id                String         @id @default(auto()) @map("_id") @db.ObjectId
  address           String
  donationDate      DateTime       
  totalParticipants String
  bountyAmount      String
  participants      Participant[]
}

model Participant {
  id              String         @id @default(auto()) @map("_id") @db.ObjectId
  publicKey       String         @unique
  name            String?
  address         String?
  gender          String?
  age             String?
  contactEmail    String?
  contactNumber   String?
  sampleDisease   String?

  // CONNECTION TO DONATIONS
  donationId      String?        @db.ObjectId
  donation        Donation?      @relation(fields: [donationId], references: [id])

  // CONNECTION TO BLOOD DONATIONS
  bloodDonations  BloodDonation[]
}

model BloodDonation {
  id               String        @id @default(auto()) @map("_id") @db.ObjectId
  bloodType        String        // e.g., A+, B-, O+, AB-
  donationDate     DateTime
  expirationDate   DateTime
  volume           Int           // Volume in milliliters
  screeningStatus  String        // e.g., "Passed", "Failed"
  testResults      String?       // Results of tests, if any
  status           String        // e.g., "Pending", "Completed", "In Use", "Discarded"
  
  donorId          String        @db.ObjectId
  donor            Participant   @relation(fields: [donorId], references: [id])

  collectionSite   String        // Location where the blood was collected
  storageLocation  String        // Where the blood is stored
  transportation   String?       // Transportation details
}
